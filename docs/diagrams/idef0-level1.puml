@startuml IDEF0_Level1
!theme plain
title IDEF0 - Nível 1: Decomposição Funcional do Sistema

' Configurações profissionais otimizadas
skinparam defaultFontColor #000000
skinparam backgroundColor white
skinparam shadowing false
skinparam roundcorner 8
skinparam linetype ortho
skinparam nodesep 80
skinparam ranksep 100

skinparam rectangle {
    BorderColor #2C3E50
    FontSize 11
    FontStyle bold
    BorderThickness 2
}
skinparam package {
    BorderColor #34495E
    BackgroundColor #F8F9FA
    FontSize 12
    FontStyle bold
    BorderThickness 2
}
skinparam arrow {
    Color #34495E
    FontColor #000000
    FontSize 10
    FontStyle bold
    Thickness 2
}

' Layout horizontal otimizado
left to right direction

' Entradas (esquerda)
rectangle "**ENTRADAS (I)**\n\n● Dados Registro\n● Credenciais Login\n● Info Empresas\n● Transações\n● Solicit. Upgrade\n● Notas Fiscais" as MainInputs #FFF3E0

' Controles (topo)
rectangle "**CONTROLES (C)**\n\n● Políticas Segurança\n● Regras Negócio\n● Validações\n● Compliance" as Controls #E3F2FD

' Processos A1-A4 (centro horizontal)
rectangle "**A1**\n\n**GERENCIAR**\n**USUÁRIOS**\n\n▪ Registro/Login\n▪ Autenticação JWT\n▪ Recuperação Senha\n▪ Gestão Perfis" as A1 #E8F4FD

rectangle "**A2**\n\n**GERENCIAR**\n**EMPRESAS**\n\n▪ Cadastro Empresas\n▪ Validação Dados\n▪ Múltiplas Empresas\n▪ Empresa Ativa" as A2 #E8F5E8

rectangle "**A3**\n\n**PROCESSAR**\n**TRANSAÇÕES**\n\n▪ Criação/Edição\n▪ Validação Limites\n▪ Categorização\n▪ Persistência BD" as A3 #FFF0F8

rectangle "**A4**\n\n**CONTROLAR**\n**ASSINATURAS**\n\n▪ Gestão Planos\n▪ Controle Limites\n▪ Processamento Pagto\n▪ Upgrades Automáticos" as A4 #FFF8E1

rectangle "**A5**\n\n**PROCESSAR**\n**NOTAS FISCAIS**\n\n▪ Upload Arquivos\n▪ Extração Dados\n▪ Criação Fornecedores\n▪ Integração Automática" as A5 #E8F8F5

' Saídas (direita)
rectangle "**SAÍDAS (O)**\n\n● Tokens JWT\n● Empresas Ativas\n● Transações Valid.\n● Relatórios\n● Status Assinat.\n● Dados Fiscais" as MainOutputs #F3E5F5

' Mecanismos (base)
rectangle "**MECANISMOS (M)**\n\n● Django REST\n● PostgreSQL\n● JWT System\n● Payment Gateway\n● Email Service\n● OCR/XML Parser\n● File Storage" as Mechanisms #ECEFF1

' Layout horizontal IDEF0
MainInputs -[hidden]right- A1
A1 -[hidden]right- A2
A2 -[hidden]right- A3
A3 -[hidden]right- A4
A4 -[hidden]right- A5
A5 -[hidden]right- MainOutputs

Controls -[hidden]down- A2
A2 -[hidden]down- Mechanisms

' Fluxos ICOM padrão IDEF0
' Entradas (I)
MainInputs -right-> A1 : **Dados**\n**Usuário**
A1 -right-> A2 : **Usuário**\n**Autenticado**
A2 -right-> A3 : **Contexto**\n**Empresa**
A3 -right-> A4 : **Verificar**\n**Limites**
A4 -right-> A5 : **Status**\n**Plano**
A5 -right-> MainOutputs : **Resultados**\n**Processados**

' Controles (C)
Controls -down-> A1 : **Políticas**
Controls -down-> A2 : **Regras**
Controls -down-> A3 : **Validações**
Controls -down-> A4 : **Compliance**
Controls -down-> A5 : **Validações**

' Mecanismos (M)
A1 -down-> Mechanisms : **Utiliza**
A2 -down-> Mechanisms : **Utiliza**
A3 -down-> Mechanisms : **Utiliza**
A4 -down-> Mechanisms : **Utiliza**
A5 -down-> Mechanisms : **Utiliza**

' Fluxos internos (pontilhados)
A1 -.down.> A3 : **Perfil**
A2 -.down.> A4 : **Empresa**
A4 -.up.> A3 : **Limites**
A5 -.left.> A3 : **Transações**\n**NF-e**
A5 -.left.> A2 : **Fornecedores**

' Legenda IDEF0
legend right
**DECOMPOSIÇÃO A-0:**
**A1:** Gerenciar Usuários
**A2:** Gerenciar Empresas  
**A3:** Processar Transações
**A4:** Controlar Assinaturas
**A5:** Processar Notas Fiscais

**Fluxo:** A1→A2→A3→A4→A5
endlegend

@enduml
